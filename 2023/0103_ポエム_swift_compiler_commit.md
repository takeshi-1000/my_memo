この記事は、swiftにコントリビュートした際のポエムです

https://github.com/apple/swift/pull/62777

## 背景

自身が参画するプロジェクトにおいて、Xcode13.4.1からXcode14にした際に、closure内部のenum文のcaseの展開ができなくなったので、その修正を試みた
（発生するサンプルコードは、PR内に添付）

closure内の、enumのcase文の展開する際に、type checking（型検査）に失敗してしまったので、
失敗しないようなロジックにならないか、調査した

モチベーションとしては言語処理のロジックの調査/修正をすることでなんとなくコンパイラの理解を深めたいことと、appleに一度コントリビュートしたかったこと

結果的には、意味解析の中で型検査のロジックが失敗していてそれを手直ししたというのが今回の修正みたいなことになりそうで
swift5.8にも入りそう。 https://github.com/apple/swift/pull/62842

特段機能追加したわけではないが、バージョン間差異による機能低下のフォローをできたのは、swiftの挙動を守ってあげているみたいで、swiftを普段使う開発者としては良かった

一つ疑問があったが、今回の件の原因はおそらくclosureにおける multiple statementの型推論を機能させた https://forums.swift.org/t/pitch-enable-multi-statement-closure-parameter-result-type-inference/52619 の開発者体験向上のデグレだと思われるが、修正prでもテストコードを記載したように、そのテストコードが追加されていれば防げた問題だったのだろうか。

コンパイラの挙動はまだ正確に把握してないもののなんとなくいろんな構文をよしなに解釈してくれて賢くなるように作られている一方で
プログラマが表現できるコードというのは上記のテストコードのように、自動生成するのではなくあらかじめテストコードを設定することしかできないのだろうか、というのが気になった。

仮にプログラマがswiftで表現できるコードを出力するプログラムがあれば今回の件も然り、もしかすると他のコードもpathを通ってないだけで対象箇所があるかもなということは気になった。
原理的にそのような出力プログラムを開発できるか自分の今の実力では判断できないが、あったらあったで開発者が表現できるコードの改修がめちゃくちゃ捗るような気はする。
ただパターンの数は膨大だろうし、言語解釈プログラムから入力に期待されるソースコードのパターンを網羅することはやっぱり難しいのかな、というのは感じた
